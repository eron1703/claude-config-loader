# Server and Infrastructure Information
#
# Document all servers, VMs, and infrastructure resources

servers:
  # Example structure - customize for your environment
  # production_api:
  #   host: api.example.com
  #   ip: 192.168.1.100
  #   purpose: "Production API server"
  #   access: "SSH via bastion"
  #   credentials: "See 1Password: Production Servers"
  #
  # staging_api:
  #   host: staging-api.example.com
  #   ip: 192.168.1.101
  #   purpose: "Staging environment"
  #   access: "Direct SSH"
  #   credentials: "See 1Password: Staging"

  localhost:
    host: localhost
    ip: 127.0.0.1
    purpose: "Local development environment"
    access: "Direct"
    platform: "macOS with OrbStack"
    docker: "OrbStack (NOT Docker Desktop)"
    workspace: "~/projects/"
    notes: |
      - All development happens locally via Docker/OrbStack
      - Multiple users/agents work in parallel
      - NEVER shut down OrbStack service globally
      - Only manage individual containers

  demo-server:
    host: demo-server
    ip: 65.21.153.235
    purpose: "Demo/staging server for testing and demos"
    access: "SSH (see connection details below)"
    platform: "Linux (K3S Kubernetes)"
    credentials: "See GitLab CI/CD Variables: SSH_PRIVATE_KEY, DEMO_SERVER"
    infrastructure:
      kubernetes: "K3S (lightweight Kubernetes) with 60+ pods across 8 namespaces"
      containers: "13 active Docker containers"
      reverse_proxy: "Nginx on port 80"
      monitoring: "Grafana, Prometheus, Loki stack"
      ci_cd: "GitLab Runner, Jenkins"
    services:
      - "arangodb-main:8529 (used by engage project and SDX)"
      - "sdx-mcp-server:8011 (Plane MCP Server - 40 tools)"
      - "sdx-backend:8010"
      - "sdx-frontend:3010"
      - "flowmaster-backend:8000"
      - "flowmaster-frontend:3000"
      - "guard-mobile-backend:8004"
      - "employee-backend:8001"
      - "employee-frontend:3001"
      - "plane-web:8083 (Plane Frontend Web UI)"
      - "plane-api:8012 (Plane MCP Server)"
    open_ports:
      - "80 (Nginx reverse proxy)"
      - "8000 (Flowmaster Backend)"
      - "8004 (Guard Mobile Backend)"
      - "8010 (SDX Backend)"
      - "8011 (SDX MCP Server)"
      - "8529 (ArangoDB)"
      - "8012 (Plane MCP Server)"
      - "8083 (Plane Web UI)"
    hetzner_firewall:
      enabled: true
      note: "Server uses Hetzner Cloud Firewall for network security"
      external_access: "Ports must be opened in Hetzner Cloud Firewall for external access"
      management: "Configure via Hetzner Cloud Console or API"
      current_rules:
        - "Port 80 (HTTP) - Open"
        - "Port 22 (SSH) - Open"
        - "Port 8000-8083 (Application ports) - Configure as needed"
    connection:
      user_ben:
        host: demo-server
        hostname: 65.21.153.235
        user: ben
        port: 22
        identity_file: ~/.ssh/ben_demo
        connect: "ssh demo-server"
      user_root:
        host: demo-server-root
        hostname: 65.21.153.235
        user: root
        port: 22
        identity_file: ~/.ssh/id_ed25519_demo
        connect: "ssh demo-server-root"
      ci_cd_deploy:
        hostname: 65.21.153.235
        user: root
        port: 22
        key_type: ED25519
        identity: "gitlab-ci-deploy"
        credentials: "GitLab CI/CD: SSH_PRIVATE_KEY"
    mcp_server:
      name: "SDX MCP Server"
      container: "sdx-mcp-server"
      port: 8011
      status: "Running (up 7+ days)"
      health_endpoint: "http://localhost:8011/health"
      tools_loaded: 40
      pillars:
        - "Admin (11 tools)"
        - "Ingest (10 tools)"
        - "Discovery (9 tools)"
        - "Data Router (10 tools)"
      connections:
        primary_database:
          type: "ArangoDB"
          container: "arangodb-main"
          port: 8529
          database: "sdx"
          collections: 17
          credentials: "See GitLab CI/CD or /opt/sdx/backend/.env"
        ai_services:
          - "OpenAI API (embeddings: text-embedding-3-small)"
          - "OpenRouter API (LLM annotations)"
        data_sources:
          - "PostgreSQL (primary, fully implemented)"
          - "MySQL (configured, not implemented)"
          - "Oracle (configured, not implemented)"
          - "SQL Server (configured, not implemented)"
          - "MongoDB (configured, not implemented)"
        webhooks:
          method: "HTTP POST"
          authentication: "HMAC-SHA256"
          retry_policy: "3 retries with exponential backoff"
      documentation:
        location: "~/projects/plane-mcp-server/"
        files:
          - "README_INVESTIGATION.md"
          - "INVESTIGATION_SUMMARY.md"
          - "CONNECTIONS_QUICK_REFERENCE.md"
          - "SDX_MCP_SERVER_INVESTIGATION.md"
          - "ARCHITECTURE_DIAGRAM.md"
    plane_status:
      main_app: "DEPLOYED"
      version: "Plane CE v1.2.1"
      deployment_path: "/opt/plane/"
      deployment_method: "Docker Compose"
      web_ui:
        url: "http://65.21.153.235:8083"
        port: 8083
      mcp_server:
        status: "RUNNING"
        url: "http://65.21.153.235:8012"
        port: 8012
        deployment_path: "/opt/plane-mcp-server/"
      containers:
        count: 13
        services:
          - "plane-web (Frontend Web UI)"
          - "plane-admin (Admin Panel)"
          - "plane-space (Public Space)"
          - "plane-api (Backend API)"
          - "plane-worker (Background Worker)"
          - "plane-beat-worker (Celery Beat Scheduler)"
          - "plane-live (Real-time Service)"
          - "plane-proxy (Nginx Reverse Proxy)"
          - "plane-db (PostgreSQL Database)"
          - "plane-redis (Redis Cache)"
          - "plane-mq (RabbitMQ Message Queue)"
          - "plane-minio (MinIO Object Storage)"
          - "plane-mcp-server (MCP Integration)"
      admin_user: "admin@flowmaster.dev"
      workspace:
        name: "flowmaster"
        project: "FM (FlowMaster)"
      api_key: "plane_api_b91c8c1ffd1448d0bd0130bbc279b124"
      users:
        - "admin@flowmaster.dev"
        - "benjamin@flowmaster.dev"
        - "irtiza.s2918@gmail.com"
        - "muhammadsadiqrajani@gmail.com"
        - "ar.raza5092@gmail.com"
    notes: |
      - Configured in ~/.ssh/config with two access methods
      - ben user: ssh demo-server (key: ~/.ssh/ben_demo)
      - root user: ssh demo-server-root (key: ~/.ssh/id_ed25519_demo)
      - CI/CD deploy key in GitLab (gitlab-ci-deploy)
      - engage project connects to ArangoDB on this server
      - SDX MCP Server connects to same ArangoDB instance (sdx database)
      - Full K3S Kubernetes cluster with monitoring stack
      - Used for demos and staging deployments
      - Comprehensive documentation saved to ~/projects/plane-mcp-server/

  flowmaster-app-server:
    host: flowmaster-app
    ip: 91.98.159.56
    purpose: "FlowMaster application server - all environments (dev, demo, staging, production)"
    access: "SSH (key from GitLab CI/CD: SSH_PRIVATE_KEY)"
    platform: "Ubuntu 24.04.3 LTS"
    credentials: "GitLab CI/CD Variables: SSH_PRIVATE_KEY, SERVER_HOST"
    infrastructure:
      runtime: "Docker + Docker Compose"
      web_server: "Nginx (reverse proxy + SSL termination via Let's Encrypt)"
      environments:
        development:
          domain: "dev.flow-master.ai"
          frontend_port: 6000
          backend_port: 6001
          path: "/srv/flowmaster/dev/"
          branch: "develop"
        demo:
          domain: "demo.flow-master.ai"
          frontend_port: 5000
          backend_port: 5001
          path: "/srv/flowmaster/demo/"
          branch: "demo"
        staging:
          domain: "staging.flow-master.ai"
          frontend_port: 4000
          backend_port: 4001
          path: "/srv/flowmaster/staging/"
          branch: "staging"
        production:
          domain: "app.flow-master.ai"
          frontend_port: 3002
          backend_port: 3001
          path: "/opt/flowmaster-prod/"
          branch: "production"
    services:
      - "FlowMaster Backend (FastAPI/Python)"
      - "FlowMaster Frontend (React/Vite + Nginx)"
      - "Nginx reverse proxy (SSL termination)"
    connection:
      user_root:
        hostname: 91.98.159.56
        user: root
        port: 22
        key_source: "GitLab CI/CD: SSH_PRIVATE_KEY"
        connect: "ssh -i ~/.ssh/id_ed25519_flowmaster_server root@91.98.159.56"
    notes: |
      - All 4 FlowMaster environments run on this single server
      - SSH key stored in GitLab CI/CD variable SSH_PRIVATE_KEY
      - CI/CD deploys via GitLab Runner using this key
      - SSL certificates managed by Let's Encrypt / certbot
      - Each environment has separate Docker Compose files
      - Documentation: OneDrive > Documentation > Server > CICD_COMPREHENSIVE_GUIDE.md

# Cloud Resources
cloud:
  # aws:
  #   account_id: "123456789012"
  #   region: us-east-1
  #   resources:
  #     - EC2 instances
  #     - RDS databases
  #     - S3 buckets
  #   credentials: "AWS CLI configured with profile 'default'"

# Access Patterns
access:
  # bastion:
  #   host: bastion.example.com
  #   purpose: "Jump host for production access"
  #   credentials: "SSH key in ~/.ssh/bastion_key"

# Notes
notes:
  - "Never store passwords in this file"
  - "Use references to password managers (1Password, LastPass, etc.)"
  - "Update this file when infrastructure changes"
